<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå - Teacher Ploy</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- ‡πÉ‡∏ä‡πâ Tailwind CSS ‡∏à‡∏≤‡∏Å CDN ‡πÅ‡∏ö‡∏ö production -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ Tailwind
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#10B981',
                    }
                }
            }
        }
    </script>
    <style>
        * {
            font-family: 'Prompt', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #fce7f3 0%, #e0e7ff 50%, #f3e8ff 100%);
        }
        
        .card-shadow {
            box-shadow: 0 10px 25px rgba(236, 72, 153, 0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #ec4899, #8b5cf6);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(236, 72, 153, 0.3);
        }
        
        .section-divider {
            background: linear-gradient(90deg, transparent, #ec4899, transparent);
            height: 2px;
            margin: 2rem 0;
        }
        
        .smooth-scroll {
            scroll-behavior: smooth;
        }
        
        .loading {
            display: none;
        }
        
        .loading.show {
            display: inline-block;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .stats-card {
            background: linear-gradient(135deg, #fdf2f8, #faf5ff);
            border: 2px solid #f9a8d4;
        }
        
        .teacher-section {
            background: linear-gradient(135deg, #f0f9ff, #fdf4ff);
        }
        
        .hidden {
            display: none;
        }
        
        .flex {
            display: flex;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen smooth-scroll">
    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-sm shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex flex-col items-center space-y-3">
                <img src="https://img5.pic.in.th/file/secure-sv1/-1ab96b02a66afe44d.png" 
                     alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" class="w-32 h-auto">
                <h1 class="text-2xl md:text-3xl font-bold text-gray-800 text-center">
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå ‚Äì ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô Teacher Ploy
                </h1>
            </div>
            
            <!-- Navigation Menu -->
            <nav class="mt-6">
                <div class="flex justify-center space-x-4 md:space-x-8">
                    <button onclick="scrollToSection('student-section')" 
                            class="px-4 py-2 bg-pink-100 text-pink-700 rounded-full hover:bg-pink-200 transition-colors">
                        üìù ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô
                    </button>
                    <button onclick="scrollToSection('teacher-section')" 
                            class="px-4 py-2 bg-purple-100 text-purple-700 rounded-full hover:bg-purple-200 transition-colors">
                        üë©‚Äçüè´ ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏Ñ‡∏£‡∏π
                    </button>
                    <button onclick="scrollToSection('dashboard-section')" 
                            class="px-4 py-2 bg-blue-100 text-blue-700 rounded-full hover:bg-blue-200 transition-colors">
                        üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
                    </button>
                </div>
            </nav>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8 space-y-12">
        
        <!-- Section 1: Student Submission Form -->
        <section id="student-section" class="fade-in">
            <div class="bg-white rounded-3xl p-8 card-shadow">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">üìö ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
                    <p class="text-gray-600">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
                </div>
                
                <form id="studentForm" class="space-y-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                üî¢ ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                            </label>
                            <input type="number" id="studentNumber" required
                                   class="w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:border-pink-400 focus:outline-none transition-colors"
                                   placeholder="‡πÄ‡∏ä‡πà‡∏ô 15" min="1" max="50">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                üë§ ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤)
                            </label>
                            <input type="text" id="studentName" required
                                   class="w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:border-pink-400 focus:outline-none transition-colors"
                                   placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏™‡∏°‡πÉ‡∏à ‡πÉ‡∏à‡∏î‡∏µ">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                üè´ ‡∏ä‡∏±‡πâ‡∏ô/‡∏´‡πâ‡∏≠‡∏á
                            </label>
                            <select id="classroom" required
                                    class="w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:border-pink-400 focus:outline-none transition-colors">
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                                <option value="‡∏õ.1/13">‡∏õ.1/13</option>
                                <option value="‡∏õ.2/13">‡∏õ.2/13</option>
                                <option value="‡∏õ.3/13">‡∏õ.3/13</option>
                                <option value="‡∏õ.4/13">‡∏õ.4/13</option>
                                <option value="‡∏õ.5/13">‡∏õ.5/13</option>
                                <option value="‡∏õ.6/13">‡∏õ.6/13</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                üìã ‡∏ä‡∏¥‡πâ‡∏ô‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á
                            </label>
                            <select id="assignmentNumber" required
                                    class="w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:border-pink-400 focus:outline-none transition-colors">
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</option>
                                <option value="‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 1">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 1</option>
                                <option value="‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 2">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 2</option>
                                <option value="‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 3">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 3</option>
                                <option value="‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 4">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 4</option>
                                <option value="‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 5">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 5</option>
                                <option value="‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 6">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 6</option>
                                <option value="‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 7">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 7</option>
                                <option value="‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 8">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 8</option>
                                <option value="‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 9">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 9</option>
                                <option value="‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 10">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 10</option>
                            </select>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            üí≠ ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
                        </label>
                        <textarea id="description" rows="3"
                                  class="w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:border-pink-400 focus:outline-none transition-colors"
                                  placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)"></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            üîó ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ú‡∏•‡∏á‡∏≤‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
                        </label>
                        <input type="url" id="workLink"
                               class="w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:border-pink-400 focus:outline-none transition-colors"
                               placeholder="https://example.com">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            üìé ‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏á‡∏≤‡∏ô
                        </label>
                        <input type="file" id="fileUpload" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
                               class="w-full px-4 py-3 border-2 border-pink-200 rounded-xl focus:border-pink-400 focus:outline-none transition-colors file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-pink-50 file:text-pink-700 hover:file:bg-pink-100">
                        <p class="text-sm text-gray-500 mt-1">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå: PDF, Word, ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB)</p>
                    </div>
                    
                    <button type="submit" class="w-full btn-primary text-white py-4 rounded-xl font-semibold text-lg">
                        <span class="loading">‚è≥</span>
                        <span class="submit-text">üöÄ ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</span>
                    </button>
                </form>
            </div>
        </section>

        <div class="section-divider"></div>

        <!-- Section 2: Teacher Dashboard -->
        <section id="teacher-section" class="fade-in teacher-section rounded-3xl p-8">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">üë©‚Äçüè´ ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏Ñ‡∏£‡∏π</h2>
                <p class="text-gray-600">‡∏ï‡∏£‡∏ß‡∏à‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
            </div>
            
            <!-- Teacher Login -->
            <div id="teacherLogin" class="bg-white rounded-2xl p-6 card-shadow mb-6">
                <h3 class="text-xl font-semibold mb-4 text-center">üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏£‡∏π</h3>
                <div class="max-w-md mx-auto">
                    <input type="password" id="teacherPassword" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô"
                           class="w-full px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none transition-colors mb-4">
                    <button onclick="teacherLogin()" 
                            class="w-full bg-purple-500 hover:bg-purple-600 text-white py-3 rounded-xl font-semibold transition-colors">
                        ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                    </button>
                </div>
            </div>
            
            <!-- Teacher Panel (Hidden by default) -->
            <div id="teacherPanel" class="hidden">
                <div class="bg-white rounded-2xl p-6 card-shadow">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</h3>
                        <button onclick="refreshSubmissions()" 
                                class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                            üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
                        </button>
                    </div>
                    
                    <div id="submissionsList" class="space-y-4">
                        <!-- Submissions will be loaded here -->
                    </div>
                </div>
            </div>
        </section>

        <div class="section-divider"></div>

        <!-- Section 3: Dashboard Statistics -->
        <section id="dashboard-section" class="fade-in">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</h2>
                <p class="text-gray-600">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
            </div>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="stats-card rounded-2xl p-6 text-center">
                    <div class="text-3xl mb-2">üìù</div>
                    <div class="text-2xl font-bold text-pink-600" id="totalSubmissions">0</div>
                    <div class="text-gray-600">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                </div>
                
                <div class="stats-card rounded-2xl p-6 text-center">
                    <div class="text-3xl mb-2">‚úÖ</div>
                    <div class="text-2xl font-bold text-green-600" id="checkedSubmissions">0</div>
                    <div class="text-gray-600">‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß</div>
                </div>
                
                <div class="stats-card rounded-2xl p-6 text-center">
                    <div class="text-3xl mb-2">‚è≥</div>
                    <div class="text-2xl font-bold text-orange-600" id="pendingSubmissions">0</div>
                    <div class="text-gray-600">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à</div>
                </div>
                
                <div class="stats-card rounded-2xl p-6 text-center">
                    <div class="text-3xl mb-2">‚≠ê</div>
                    <div class="text-2xl font-bold text-purple-600" id="averageScore">0</div>
                    <div class="text-gray-600">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
                </div>
            </div>
            
            <!-- Recent Submissions -->
            <div class="bg-white rounded-2xl p-6 card-shadow">
                <h3 class="text-xl font-semibold mb-4">üìã ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
                <div id="recentSubmissions" class="space-y-3">
                    <!-- Recent submissions will be loaded here -->
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="bg-white/80 backdrop-blur-sm mt-16 py-8">
        <div class="container mx-auto px-4 text-center">
            <p class="text-gray-600">
                ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ T.Ploysai :: ‡∏†‡∏±‡∏ó‡∏£‡∏ô‡∏±‡∏ô‡∏ó‡πå ‡∏°‡∏∏‡πâ‡∏á‡∏ö‡∏±‡∏á | 
                ¬© 2025 ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
            </p>
        </div>
    </footer>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md mx-4 text-center">
            <div class="text-6xl mb-4">üéâ</div>
            <h3 class="text-2xl font-bold text-green-600 mb-2">‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
            <p class="text-gray-600 mb-6">‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
            <button onclick="closeModal()" 
                    class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-xl font-semibold transition-colors">
                ‡∏ï‡∏Å‡∏•‡∏á
            </button>
        </div>
    </div>

    <script>
        // Configuration
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby8ndOiJ4-cEbbvLYrn0s0p-pXlFWO7Q-TQe0hl-bx2vh_tGJSeMyBOHubovxx3nz52/exec';
        const TEACHER_PASSWORD = 'admin999';
        
        // Utility Functions
        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }
        
        function showLoading(show = true) {
            const loading = document.querySelector('.loading');
            const submitText = document.querySelector('.submit-text');
            
            if (show) {
                loading.classList.add('show');
                submitText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...';
            } else {
                loading.classList.remove('show');
                submitText.textContent = 'üöÄ ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô';
            }
        }
        
        function showModal() {
            document.getElementById('successModal').classList.remove('hidden');
            document.getElementById('successModal').classList.add('flex');
        }
        
        function closeModal() {
            document.getElementById('successModal').classList.add('hidden');
            document.getElementById('successModal').classList.remove('flex');
        }
        
        // File to Base64 conversion
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => {
                    const base64 = reader.result.split(',')[1];
                    resolve(base64);
                };
                reader.onerror = error => reject(error);
            });
        }
        
        // Student Form Submission
        async function handleStudentFormSubmission(e) {
            e.preventDefault();
            showLoading(true);
            
            try {
                const fileInput = document.getElementById('fileUpload');
                const formData = new FormData();
                
                // Add form data to FormData
                formData.append('studentNumber', document.getElementById('studentNumber').value);
                formData.append('studentName', document.getElementById('studentName').value);
                formData.append('classroom', document.getElementById('classroom').value);
                formData.append('assignmentType', document.getElementById('assignmentNumber').value);
                formData.append('description', document.getElementById('description').value);
                formData.append('workLink', document.getElementById('workLink').value);
                formData.append('submissionDate', new Date().toLocaleString('th-TH'));
                
                // Handle file upload
                if (fileInput.files[0]) {
                    const file = fileInput.files[0];
                    
                    // Check file size (10MB limit)
                    if (file.size > 10 * 1024 * 1024) {
                        alert('‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡πÄ‡∏Å‡∏¥‡∏ô 10MB)');
                        showLoading(false);
                        return;
                    }
                    
                    formData.append('file', file);
                }
                
                // Send to Google Apps Script
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    showModal();
                    document.getElementById('studentForm').reset();
                    updateDashboard(); // Refresh dashboard
                } else {
                    throw new Error(result.message);
                }
                
            } catch (error) {
                console.error('Error:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô: ' + error.message);
            } finally {
                showLoading(false);
            }
        }
        
        // Teacher Login
        function teacherLogin() {
            const password = document.getElementById('teacherPassword').value;
            
            if (password === TEACHER_PASSWORD) {
                document.getElementById('teacherLogin').style.display = 'none';
                document.getElementById('teacherPanel').classList.remove('hidden');
                loadSubmissions();
            } else {
                alert('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                document.getElementById('teacherPassword').value = '';
            }
        }
        
        // Load submissions for teacher
        async function loadSubmissions() {
            try {
                const response = await fetch(APPS_SCRIPT_URL + '?action=getSubmissions');
                const data = await response.json();
                
                const submissionsList = document.getElementById('submissionsList');
                submissionsList.innerHTML = '';
                
                if (data.status === 'success' && data.data.length > 0) {
                    data.data.forEach((submission, index) => {
                        const submissionCard = createSubmissionCard(submission, index);
                        submissionsList.appendChild(submissionCard);
                    });
                } else {
                    submissionsList.innerHTML = '<p class="text-gray-500 text-center py-8">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</p>';
                }
            } catch (error) {
                console.error('Error loading submissions:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
            }
        }
        
        // Create submission card for teacher
        function createSubmissionCard(submission, index) {
            const card = document.createElement('div');
            card.className = 'bg-gray-50 rounded-xl p-4 border-l-4 border-pink-400';
            
            const isChecked = submission['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞'] === '‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß';
            const statusClass = isChecked ? 'bg-green-100 text-green-700' : 'bg-orange-100 text-orange-700';
            
            card.innerHTML = `
                <div class="flex justify-between items-start mb-3">
                    <div>
                        <h4 class="font-semibold text-lg">${submission['‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•']} (‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ${submission['‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà']})</h4>
                        <p class="text-gray-600">${submission['‡∏ä‡∏±‡πâ‡∏ô/‡∏´‡πâ‡∏≠‡∏á']} - ${submission['‡∏ä‡∏¥‡πâ‡∏ô‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á']}</p>
                        <p class="text-sm text-gray-500">‡∏™‡πà‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${new Date(submission['‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á']).toLocaleString('th-TH')}</p>
                    </div>
                    <span class="px-3 py-1 rounded-full text-sm ${statusClass}">
                        ${submission['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞']}
                    </span>
                </div>
                
                ${submission['‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢'] ? `<p class="text-gray-700 mb-2"><strong>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:</strong> ${submission['‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢']}</p>` : ''}
                ${submission['‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ú‡∏•‡∏á‡∏≤‡∏ô'] ? `<p class="mb-2"><strong>‡∏•‡∏¥‡∏á‡∏Å‡πå:</strong> <a href="${submission['‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ú‡∏•‡∏á‡∏≤‡∏ô']}" target="_blank" class="text-blue-500 hover:underline">‡∏î‡∏π‡∏ú‡∏•‡∏á‡∏≤‡∏ô</a></p>` : ''}
                ${submission['‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö'] ? `<p class="mb-3"><strong>‡πÑ‡∏ü‡∏•‡πå:</strong> <a href="${submission['‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö']}" target="_blank" class="text-blue-500 hover:underline">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</a></p>` : ''}
                
                <div class="flex gap-3 mt-4">
                    <input type="number" id="score_${index}" placeholder="‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô" min="0" max="100" 
                           value="${submission['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô'] || ''}"
                           class="px-3 py-2 border border-gray-300 rounded-lg w-24">
                    <input type="text" id="comment_${index}" placeholder="‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô" 
                           value="${submission['‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏Ñ‡∏£‡∏π'] || ''}"
                           class="flex-1 px-3 py-2 border border-gray-300 rounded-lg">
                    <button onclick="updateGrade(${index}, '${submission['‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà']}', '${submission['‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•']}')" 
                            class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                    </button>
                </div>
            `;
            
            return card;
        }
        
        // Update grade
        async function updateGrade(index, studentNumber, studentName) {
            const score = document.getElementById(`score_${index}`).value;
            const comment = document.getElementById(`comment_${index}`).value;

            if (score && (isNaN(score) || score < 0 || score > 100)) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0-100');
                return;
            }

            try {
                const formData = new FormData();
                formData.append('action', 'updateGrade');
                formData.append('studentNumber', studentNumber);
                formData.append('studentName', studentName);
                formData.append('score', score);
                formData.append('comment', comment);

                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.status === 'success') {
                    alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    loadSubmissions();
                    updateDashboard();
                } else {
                    throw new Error(result.message);
                }

            } catch (error) {
                console.error('Error updating grade:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ' + error.message);
            }
        }
        
        // Refresh submissions
        function refreshSubmissions() {
            loadSubmissions();
            updateDashboard();
        }
        
        // Update dashboard statistics
        async function updateDashboard() {
            try {
                const response = await fetch(APPS_SCRIPT_URL + '?action=getStats');
                const stats = await response.json();
                
                if (stats.status === 'success' && stats.data) {
                    document.getElementById('totalSubmissions').textContent = stats.data.totalSubmissions || 0;
                    document.getElementById('checkedSubmissions').textContent = stats.data.statusCounts['‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß'] || 0;
                    document.getElementById('pendingSubmissions').textContent = stats.data.statusCounts['‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à'] || 0;
                }

                // Load recent submissions
                loadRecentSubmissions();

            } catch (error) {
                console.error('Error updating dashboard:', error);
            }
        }
        
        // Load recent submissions
        async function loadRecentSubmissions() {
            try {
                const response = await fetch(APPS_SCRIPT_URL + '?action=getSubmissions');
                const data = await response.json();

                const recentContainer = document.getElementById('recentSubmissions');
                recentContainer.innerHTML = '';

                if (data.status === 'success' && data.data.length > 0) {
                    // Get 5 most recent submissions
                    const recent = data.data.slice(-5).reverse();

                    recent.forEach(submission => {
                        const item = document.createElement('div');
                        item.className = 'flex justify-between items-center p-3 bg-gray-50 rounded-lg';
                        item.innerHTML = `
                            <div>
                                <span class="font-medium">${submission['‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•']}</span>
                                <span class="text-gray-500 ml-2">${submission['‡∏ä‡∏¥‡πâ‡∏ô‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á']}</span>
                            </div>
                            <span class="text-sm text-gray-500">${new Date(submission['‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á']).toLocaleString('th-TH')}</span>
                        `;
                        recentContainer.appendChild(item);
                    });
                } else {
                    recentContainer.innerHTML = '<p class="text-gray-500 text-center py-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</p>';
                }

            } catch (error) {
                console.error('Error loading recent submissions:', error);
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Add event listener to form
            const studentForm = document.getElementById('studentForm');
            if (studentForm) {
                studentForm.addEventListener('submit', handleStudentFormSubmission);
            }
            
            // Add event listener for Enter key in teacher password
            const teacherPasswordInput = document.getElementById('teacherPassword');
            if (teacherPasswordInput) {
                teacherPasswordInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        teacherLogin();
                    }
                });
            }
            
            // Load initial dashboard
            updateDashboard();
            
            console.log('‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
        });
        
        // Auto refresh dashboard every 30 seconds
        setInterval(updateDashboard, 30000);
    </script>
</body>
</html>